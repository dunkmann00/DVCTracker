<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>DVCTracker Important Criteria</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/5.1.3/bootstrap.min.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/dvctracker-criteria-1.css') }}">
    </head>
    <body>
        {% from "criteria/criteria_form_row.html" import add_row with context%}
        {% from "criteria/criteria_alert.html" import add_alert %}
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-7">
                    <header id="header" class="text-center mb-5">
                        <h1>{% if env_label %}({{ env_label }}) {% endif %}DVC Tracker - Important Criteria</h1>
                        <h3>{{ date()|datetimeformat('%B %-d, %Y %-I:%M%p') }}</h3>
                    </header>
                    {% with messages = get_flashed_messages(category_filter=["success"]) %}
                    {% if messages %}
                    <div id="messages" class="alert alert-success align-items-center d-flex alert-dismissible fade show" role="alert">
                        <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="{{ url_for('static', filename='images/bootstrap-icons-1.svg', _anchor='check-circle-fill') }}"/></svg>
                        <h4 class="alert-heading mb-0">{{ messages|first }}</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                    {% endif %}
                    {% endwith %}
                    {% if form.errors %}
                        {% if form.csrf_token.errors or form.important_only.errors %}
                            {{ add_alert(form) }}
                        {% else %}
                            {{ add_alert("Please check the errors below.") }}
                        {% endif %}
                    {% endif %}

                    <form id="criteria_form" method="post" {% if request.method == "POST" %}class="was-validated"{% endif %} novalidate>
                    {{ form.csrf_token }}
                        <div class="mb-3">
                            <h4 class="mb-2">{{ form.important_only.label.text }}</h4>
                            {% for choice in form.important_only %}
                            <div class="form-check form-check-inline me-5">
                                {{ choice(class="form-check-input red-input") }}
                                {{ choice.label(class="form-check-label") }}
                            </div>
                            {% endfor %}
                            <button id="add_criteria_button" type="button" class="btn symbol-button plus-button position-fixed bottom-0 end-0 m-4">
                                <svg class="bi bg-white rounded-circle" width="38" height="38">
                                    <title>Add Criteria</title>
                                    <use xlink:href="{{ url_for('static', filename='images/bootstrap-icons-1.svg', _anchor='plus-circle-fill') }}"/>
                                </svg>
                            </button>
                        </div>
                        <div id="criteriaRows">
                            {% for criteria in form.important_criteria %}
                                {% if criteria.errors %}
                                    {{ add_alert(criteria) }}
                                {% endif %}
                                {{ add_row(loop.index0, criteria) }}
                            {% endfor %}
                        </div>
                        <button type="submit" class="btn btn-danger bottom-spacing">Submit</button>
                    </form>
                </div>
            </div>
        </div>

        <template id="template_form_row">
            {{ add_row(0, template_form.important_criteria|first) }}
        </template>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

        <script src="{{ url_for('static', filename='js/dvctracker-criteria-1.js') }}"></script>
    </body>
</html>
